<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sudoku Solver</title>
<style>
  body{font-family:system-ui,Segoe UI,Roboto;display:flex;flex-direction:column;align-items:center;padding:20px;background:#f7f8fb}
  h1{margin:8px 0}
  table{border-collapse:collapse}
  td{border:1px solid #999;padding:0}
  input.cell{width:44px;height:44px;text-align:center;font-size:18px;border:0;outline:none;background:white}
  /* thicker borders for 3x3 boxes */
  td.box-right{border-right:3px solid #333}
  td.box-bottom{border-bottom:3px solid #333}
  .controls{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap}
  button{padding:8px 12px;border-radius:8px;border:0;background:#2b6cb0;color:white;cursor:pointer}
  button.secondary{background:#4a5568}
  .msg{margin-top:10px;height:20px}
  .conflict{background:#ffd6d6}
</style>
</head>
<body>
  <h1>Sudoku Solver</h1>
  <p>Empty cells = blank. Type 1–9 only. Click <b>Solve</b>.</p>

  <table id="board"></table>

  <div class="controls">
    <button id="solveBtn">Solve ✅</button>
    <button id="validateBtn" class="secondary">Validate</button>
    <button id="clearBtn" class="secondary">Clear</button>
    <button id="sampleBtn" class="secondary">Load Sample</button>
  </div>
  <div class="msg" id="msg"></div>

<script>
/* Build 9x9 table */
const boardEl = document.getElementById('board');
for(let r=0;r<9;r++){
  const tr = document.createElement('tr');
  for(let c=0;c<9;c++){
    const td = document.createElement('td');
    if((c+1)%3===0 && c!==8) td.classList.add('box-right');
    if((r+1)%3===0 && r!==8) td.classList.add('box-bottom');
    const inp = document.createElement('input');
    inp.className='cell';
    inp.maxLength=1;
    inp.id = `cell-${r}-${c}`;
    inp.addEventListener('input', e=>{
      const v = e.target.value.replace(/[^1-9]/g,'');
      e.target.value = v;
    });
    td.appendChild(inp);
    tr.appendChild(td);
  }
  boardEl.appendChild(tr);
}

const getBoard = ()=>{
  const b = Array.from({length:9},()=>Array(9).fill(0));
  for(let r=0;r<9;r++){
    for(let c=0;c<9;c++){
      const v = document.getElementById(`cell-${r}-${c}`).value;
      b[r][c] = v===''?0:parseInt(v,10);
    }
  }
  return b;
};
const setBoard = (b)=>{
  for(let r=0;r<9;r++) for(let c=0;c<9;c++){
    document.getElementById(`cell-${r}-${c}`).value = b[r][c]===0 ? '' : b[r][c];
  }
};

/* Validation helpers */
function isValidPlacement(board, row, col, num){
  for(let c=0;c<9;c++) if(board[row][c]===num) return false;
  for(let r=0;r<9;r++) if(board[r][col]===num) return false;
  const br = Math.floor(row/3)*3, bc = Math.floor(col/3)*3;
  for(let r=br;r<br+3;r++) for(let c=bc;c<bc+3;c++) if(board[r][c]===num) return false;
  return true;
}

/* Backtracking solver */
function findEmpty(board){
  for(let r=0;r<9;r++) for(let c=0;c<9;c++) if(board[r][c]===0) return [r,c];
  return null;
}
function solveBacktrack(board){
  const spot = findEmpty(board);
  if(!spot) return true;
  const [r,c] = spot;
  for(let n=1;n<=9;n++){
    if(isValidPlacement(board,r,c,n)){
      board[r][c]=n;
      if(solveBacktrack(board)) return true;
      board[r][c]=0;
    }
  }
  return false;
}

/* UI buttons */
const msgEl = document.getElementById('msg');
document.getElementById('solveBtn').addEventListener('click', ()=>{
  clearHighlights();
  const b = getBoard();
  if(!validateBoard(b,true)) return;
  const copy = b.map(row=>row.slice());
  const ok = solveBacktrack(copy);
  if(ok){ setBoard(copy); msgEl.textContent = 'Solved ✅'; }
  else msgEl.textContent = 'No solution found ❌';
});
document.getElementById('validateBtn').addEventListener('click', ()=>{
  clearHighlights();
  const b = getBoard();
  validateBoard(b,false);
});
document.getElementById('clearBtn').addEventListener('click', ()=>{
  setBoard(Array.from({length:9},()=>Array(9).fill(0)));
  msgEl.textContent='';
  clearHighlights();
});
document.getElementById('sampleBtn').addEventListener('click', ()=>{
  const sample = [
    [5,3,0,0,7,0,0,0,0],
    [6,0,0,1,9,5,0,0,0],
    [0,9,8,0,0,0,0,6,0],
    [8,0,0,0,6,0,0,0,3],
    [4,0,0,8,0,3,0,0,1],
    [7,0,0,0,2,0,0,0,6],
    [0,6,0,0,0,0,2,8,0],
    [0,0,0,4,1,9,0,0,5],
    [0,0,0,0,8,0,0,7,9],
  ];
  setBoard(sample); msgEl.textContent='Sample loaded';
});

/* Validate board and highlight conflicts */
function validateBoard(board, showMsg=true){
  let ok=true;
  for(let r=0;r<9;r++){
    for(let c=0;c<9;c++){
      const v = board[r][c];
      if(v===0) continue;
      // temporarily remove and test
      board[r][c]=0;
      if(!isValidPlacement(board,r,c,v)){
        ok=false;
        highlightCell(r,c);
      }
      board[r][c]=v;
    }
  }
  if(showMsg) msgEl.textContent = ok ? 'Board valid ✅' : 'Conflicts found ❌';
  return ok;
}
function highlightCell(r,c){
  document.getElementById(`cell-${r}-${c}`).classList.add('conflict');
}
function clearHighlights(){
  document.querySelectorAll('.cell').forEach(i=>i.classList.remove('conflict'));
}
</script>
</body>
</html>
